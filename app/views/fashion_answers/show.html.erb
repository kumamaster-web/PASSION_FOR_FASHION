<div class="text-center">
  <h1>Fashion Profile Results</h1>

  <div class="card mb-3">
    <div class="card-header">Photo</div>
    <div class="card-body">
      <% if @fashion_answer.image_path.present? %>
        <%= image_tag @fashion_answer.image_path, style: "max-width: 300px;" %>
      <% end %>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-header">What you said..</div>
    <div class="card-body">
      <p><strong>Lifestyle:</strong> <%= @fashion_answer.lifestyle %></p>
      <p><strong>Colors:</strong> <%= @fashion_answer.colors %></p>
      <p><strong>Occasion:</strong> <%= @fashion_answer.occasion %></p>
      <p><strong>Comfort:</strong> <%= @fashion_answer.comfort %></p>
      <p><strong>Statement:</strong> <%= @fashion_answer.statement %></p>
      <p><strong>Personality:</strong> <%= @fashion_answer.personality_type %></p>
    </div>
  </div>

  <h2>Fashion Profile Recommendations</h2>

  <% if @fashion_answer.style.present? %>
    <% if @fashion_answer.persona.present? %>
      <div class="card mb-3">
        <div class="card-body">
          <h3><%= @fashion_answer.persona %></h3>
        </div>
      </div>
    <% end %>

    <div class="card mb-3">
      <div class="card-header">Style</div>
      <div class="card-body">
        <p><%= @fashion_answer.style %></p>
      </div>
    </div>

    <div class="card mb-3">
      <div class="card-header">Colour Palette</div>
      <div class="card-body">
        <p><%= @fashion_answer.colour_palette %></p>
      </div>
    </div>

    <div class="card mb-3">
      <div class="card-header">Recommended Brands</div>
      <div class="card-body">
        <p><%= @fashion_answer.recommended_brands %></p>
      </div>
    </div>

    <div class="card mb-3">
      <div class="card-header">Where to Shop</div>
      <div class="card-body">
        <p><%= @fashion_answer.where_to_shop %></p>
      </div>
    </div>

    <!-- Shop Your Style Section -->
    <% if @products.present? %>
      <div class="card mb-3">
        <div class="card-header">
          <h4 class="mb-0">üõçÔ∏è Shop Your Style</h4>
        </div>
        <div class="card-body">
          <p class="text-muted mb-4">Products matching your recommended brands and colors</p>
          <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4">
            <% @products.first(8).each do |product| %>
              <div class="col">
                <div class="card h-100 product-card">
                  <% if product[:thumbnail].present? %>
                    <img src="<%= product[:thumbnail] %>" class="card-img-top" alt="<%= product[:title] %>" style="height: 200px; object-fit: contain; padding: 10px;">
                  <% end %>
                  <div class="card-body d-flex flex-column">
                    <h6 class="card-title" style="font-size: 0.9rem; line-height: 1.3; height: 2.6em; overflow: hidden;"><%= product[:title]&.truncate(60) %></h6>
                    <% if product[:source].present? %>
                      <p class="text-muted mb-1" style="font-size: 0.75rem;"><%= product[:source] %></p>
                    <% end %>
                    <% if product[:rating].present? %>
                      <p class="mb-1">
                        <% product[:rating].to_i.times do %>‚≠ê<% end %>
                        <small class="text-muted">(<%= product[:reviews] || 0 %>)</small>
                      </p>
                    <% end %>
                    <p class="card-text fw-bold text-success mt-auto"><%= product[:price] || 'Price unavailable' %></p>
                    <a href="<%= product[:link] %>" target="_blank" rel="noopener" class="btn btn-outline-primary btn-sm mt-2">View Product</a>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  <% else %>
    <div class="card mb-3">
      <div class="card-body">
        <p>AI recommendations unavailable. Try again later or <%= link_to "retake the quiz", new_fashion_answer_path %>.</p>
      </div>
    </div>
  <% end %>

  <div class="mt-3">
    <%= link_to "Take Another Quiz", new_fashion_answer_path, class: "btn btn-primary" %>
    <%= link_to "View History", fashion_answers_path, class: "btn btn-secondary" %>
  </div>
</div>

<div class="text-center">
  <h1>Fashion Profile Results</h1>

  <div class="card mb-3">
    <div class="card-header">AI thinks ...</div>
    <div class="card-body">

    </div>
  </div>

  <div class="card mb-3">
    <div class="card-header">What you said..</div>

    <div class="card-body justify-content-center">
      <div >
        <% if @fashion_answer.user_image.present? %>
          <%= cl_image_tag @fashion_answer.user_image.key, alt: "Uploaded photo", class: "uploaded-photo user-image" %>
        <% else %>
        <p>No photo uploaded</p>
        <% end %>
      </div>
      <p><strong>Gender:</strong> <%= @fashion_answer.gender %></p>
      <p><strong>Lifestyle:</strong> <%= @fashion_answer.lifestyle %></p>
      <p><strong>Colors:</strong> <%= @fashion_answer.colors %></p>
      <p><strong>Occasion:</strong> <%= @fashion_answer.occasion %></p>
      <p><strong>Comfort:</strong> <%= @fashion_answer.comfort %></p>
      <p><strong>Statement:</strong> <%= @fashion_answer.statement %></p>
      <p><strong>Personality:</strong> <%= @fashion_answer.personality_type %></p>
    </div>
  </div>



  <h2>Fashion Profile Recommendations</h2>

  <% if @fashion_answer.style.present? %>
    <% if @fashion_answer.persona.present? %>
      <div class="card mb-3">
        <div class="card-body">
          <h3><%= @fashion_answer.persona %></h3>
        </div>
      </div>
    <% end %>

    <div class="card mb-3">
      <div class="card-header">Style</div>
      <div class="card-body">
        <p><%= @fashion_answer.style %></p>
      </div>
    </div>

    <div class="card mb-3">
      <div class="card-header">Colour Palette</div>
      <div class="card-body">
        <p><%= @fashion_answer.colour_palette %></p>
      </div>
    </div>

    <div class="card mb-3">
      <div class="card-header">Recommended Brands</div>
      <div class="card-body">
        <p><%= @fashion_answer.recommended_brands %></p>
      </div>
    </div>

    <div class="card mb-3">
      <div class="card-header">Where to Shop</div>
      <div class="card-body">
        <p><%= @fashion_answer.where_to_shop %></p>
      </div>
    </div>

    <% if @product_recommendations.present? %>
      <h2 class="mt-5 mb-4">Shop Your Style</h2>
      <p class="text-muted mb-4">Products based on your recommended brands and colors</p>
      <div class="row">
        <% @product_recommendations.each do |product| %>
          <div class="col-md-3 col-sm-6 mb-4">
            <div class="card h-100 product-card">
              <% if product[:image_url].present? %>
                <%= image_tag product[:image_url], class: "card-img-top", style: "height: 180px; object-fit: contain; padding: 10px; background: #f8f9fa;", alt: product[:name] %>
              <% end %>
              <div class="card-body d-flex flex-column">
                <h6 class="card-title" style="font-size: 0.85rem; line-height: 1.3;" title="<%= product[:name] %>">
                  <%= truncate(product[:name], length: 60) %>
                </h6>
                <p class="text-muted small mb-1"><%= product[:source] %></p>
                <% if product[:rating].present? %>
                  <p class="small mb-1">
                    <span class="text-warning">â˜…</span> <%= product[:rating] %>
                    <% if product[:reviews].present? %>
                      <span class="text-muted">(<%= product[:reviews] %>)</span>
                    <% end %>
                  </p>
                <% end %>
                <p class="fw-bold text-success mt-auto mb-2"><%= product[:price] %></p>
                <%= link_to "View Product", product[:product_url],
                    class: "btn btn-outline-primary btn-sm",
                    target: "_blank",
                    rel: "noopener" %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>
  <% else %>
    <div class="card mb-3">
      <div class="card-body">
        <p>AI recommendations unavailable. Try again later or <%= link_to "retake the quiz", new_fashion_answer_path %>.</p>
      </div>
    </div>
  <% end %>

  <div class="mt-3">
    <%= link_to "Take Another Quiz", new_fashion_answer_path, class: "btn btn-primary" %>
    <%= link_to "View History", fashion_answers_path, class: "btn btn-secondary" %>
  </div>
</div>
